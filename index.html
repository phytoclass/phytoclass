<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimate Chla Concentrations of Phytoplankton Groups • phytoclass</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Estimate Chla Concentrations of Phytoplankton Groups">
<meta name="description" content="Determine the chlorophyll a (Chl a) concentrations of different phytoplankton groups based on their pigment biomarkers. The method uses non-negative matrix factorisation and simulated annealing to minimise error between the observed and estimated values of pigment concentrations (Hayward et al. (2023) &lt;doi:10.1002/lom3.10541&gt;). The approach is similar to the widely used CHEMTAX program (Mackey et al. 1996) &lt;doi:10.3354/meps144265&gt;, but is more straightforward, accurate, and not reliant on initial guesses for the pigment to Chl a ratios for phytoplankton groups.">
<meta property="og:description" content="Determine the chlorophyll a (Chl a) concentrations of different phytoplankton groups based on their pigment biomarkers. The method uses non-negative matrix factorisation and simulated annealing to minimise error between the observed and estimated values of pigment concentrations (Hayward et al. (2023) &lt;doi:10.1002/lom3.10541&gt;). The approach is similar to the widely used CHEMTAX program (Mackey et al. 1996) &lt;doi:10.3354/meps144265&gt;, but is more straightforward, accurate, and not reliant on initial guesses for the pigment to Chl a ratios for phytoplankton groups.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">phytoclass</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/common-issues-f-matrix.html">Common Issues : F Matrix</a></li>
    <li><a class="dropdown-item" href="articles/custom-example.html">Example Usage : custom F &amp; MinMax Matrices</a></li>
    <li><a class="dropdown-item" href="articles/minimal-example.html">Example : Minimal</a></li>
    <li><a class="dropdown-item" href="articles/minmax.html">Table of Default F MinMax Values</a></li>
    <li><a class="dropdown-item" href="articles/phytoclass-vignette.html">The phytoclass package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/phytoclass/phytoclass/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="phytoclass">phytoclass<a class="anchor" aria-label="anchor" href="#phytoclass"></a>
</h1></div>
<p>The phytoclass package uses non-negative matrix factorization and simulated annealing to determine the chl a concentrations of different phytoplankton groups from pigment concentrations.</p>
<p>The main function is ‘Simulated annealing’. This can be used in conjuction with the cluster function, which clusters larger datasets. To understand how to use your own matrices instead of the default dataset, please see the example in the vignette.</p>
<hr>
<div class="section level3">
<h3 id="why-phytoclass">Why Phytoclass?<a class="anchor" aria-label="anchor" href="#why-phytoclass"></a>
</h3>
<ul>
<li>phytoclass is entirely open-source, whereas other methods rely on external software</li>
<li>ability to run phytoclass from R allows scripting for improved reproducibility</li>
<li>scripting also enables batch processing for running many samples</li>
<li>phytoclass features improved gradient-descent algorithms for solving the least-squares problem</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="additional-features">Additional Features<a class="anchor" aria-label="anchor" href="#additional-features"></a>
</h3>
<p>When setting up your matrices, it is important to ensure that pigments are in the same order in the Sm and Fm matrices. Chlorophyll a must be the final column.</p>
<p>There is a separate function when Divinyl chlorophyll a and Prochlorococcus are used. Here Divynl chlorophyll a must be the 2nd to last column (see ‘Fp’).</p>
<p>The ’Steepest Descent’function is similar to that of CHEMTAX, and is unconstrained by minimum and maximum values, unlike the simualted annealing function. I would use this with more caution.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>It can be installed from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"phytoclass"</span><span class="op">)</span></span></code></pre></div>
<p>Or the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"AndyMcKenzieFromNZ/phytoclass"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>For the built-in samples matrix Sm of pigment samples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/phytoclass/phytoclass/" class="external-link">phytoclass</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="st">"84545"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulated_annealing.html">simulated_annealing</a></span><span class="op">(</span><span class="va">Sm</span>, niter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Condition number = 222</span></span>
<span><span class="co">#&gt; Current error:  0.0334</span></span>
<span><span class="co">#&gt; Neighbour's error:  0.0334</span></span>
<span><span class="co">#&gt; Temperature (%):  99.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Current error:  0.0292</span></span>
<span><span class="co">#&gt; Neighbour's error:  0.0292</span></span>
<span><span class="co">#&gt; Temperature (%):  98.21</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Current error:  0.0289</span></span>
<span><span class="co">#&gt; Neighbour's error:  0.0289</span></span>
<span><span class="co">#&gt; Temperature (%):  97.32</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Current error:  0.0289</span></span>
<span><span class="co">#&gt; Neighbour's error:  0.0291</span></span>
<span><span class="co">#&gt; Temperature (%):  96.45</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Current error:  0.0289</span></span>
<span><span class="co">#&gt; Neighbour's error:  0.0295</span></span>
<span><span class="co">#&gt; Temperature (%):  95.58</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="va">Results</span><span class="op">$</span><span class="va">RMSE</span></span>
<span><span class="co">#&gt; [1] 0.02887119</span></span>
<span><span class="va">Results</span><span class="op">$</span><span class="va">MAE</span></span>
<span><span class="co">#&gt;          Per       X19but         Fuco         Neox         Viol       X19hex </span></span>
<span><span class="co">#&gt; 6.762107e-05 2.117964e-05 4.868073e-03 9.245641e-03 4.011338e-03 3.175673e-04 </span></span>
<span><span class="co">#&gt;         Allo          Zea        Chl_b        Tchla </span></span>
<span><span class="co">#&gt; 1.271716e-04 5.946094e-05 3.004235e-03 6.487357e-02</span></span>
<span><span class="va">Results</span><span class="op">$</span><span class="va">Error</span></span>
<span><span class="co">#&gt;                 Per        X19but         Fuco        Neox          Viol</span></span>
<span><span class="co">#&gt;  [1,] -3.253203e-04  5.363457e-05 -0.012327735 0.004113861  0.0016646554</span></span>
<span><span class="co">#&gt;  [2,] -5.150124e-04  8.490852e-05 -0.019515955 0.003010191  0.0014654390</span></span>
<span><span class="co">#&gt;  [3,] -4.308139e-04  7.102697e-05 -0.016325323 0.005076986 -0.0044188896</span></span>
<span><span class="co">#&gt;  [4,] -3.763864e-04  6.205367e-05 -0.014262838 0.005379809 -0.0046022039</span></span>
<span><span class="co">#&gt;  [5,] -8.763904e-05  1.444878e-05 -0.003321006 0.008703848 -0.0043486318</span></span>
<span><span class="co">#&gt;  [6,] -3.571294e-05  5.887883e-06 -0.001353311 0.008530798 -0.0043429984</span></span>
<span><span class="co">#&gt;  [7,]  0.000000e+00 -3.251896e-05  0.007474381 0.007151298  0.0007978740</span></span>
<span><span class="co">#&gt;  [8,]  0.000000e+00 -2.319004e-05  0.005330158 0.002588776 -0.0004659437</span></span>
<span><span class="co">#&gt;  [9,]  0.000000e+00 -5.749674e-06  0.001321544 0.002274345  0.0015089554</span></span>
<span><span class="co">#&gt; [10,]  0.000000e+00 -3.081395e-05  0.007082488 0.007245941  0.0015906999</span></span>
<span><span class="co">#&gt; [11,]  0.000000e+00 -1.341877e-05  0.003084262 0.006617658 -0.0053975686</span></span>
<span><span class="co">#&gt; [12,]  0.000000e+00 -1.506524e-05  0.003462698 0.015971833 -0.0069289827</span></span>
<span><span class="co">#&gt; [13,]  0.000000e+00 -1.333348e-05  0.003064657 0.014568176 -0.0090934337</span></span>
<span><span class="co">#&gt; [14,]  0.000000e+00 -2.479751e-05  0.005699628 0.016813884  0.0011476034</span></span>
<span><span class="co">#&gt; [15,] -1.006561e-04  1.659487e-05 -0.003814278 0.013939555  0.0089862189</span></span>
<span><span class="co">#&gt; [16,]  0.000000e+00 -1.042338e-05  0.002395780 0.016908409  0.0116951587</span></span>
<span><span class="co">#&gt; [17,] -4.521531e-05  7.454510e-06 -0.001713396 0.009954774  0.0103869980</span></span>
<span><span class="co">#&gt; [18,]  0.000000e+00 -1.805572e-05  0.004150050 0.010623890  0.0015261320</span></span>
<span><span class="co">#&gt; [19,]  0.000000e+00 -7.308043e-06  0.001679731 0.009895152  0.0030226855</span></span>
<span><span class="co">#&gt; [20,]  0.000000e+00 -7.329856e-06  0.001684744 0.005672210  0.0024367842</span></span>
<span><span class="co">#&gt; [21,]  0.000000e+00 -8.577450e-06  0.001971500 0.008121745  0.0028953335</span></span>
<span><span class="co">#&gt; [22,] -6.645487e-06  1.095621e-06 -0.000251825 0.003468847  0.0009586975</span></span>
<span><span class="co">#&gt; [23,] -3.760915e-05  6.200505e-06 -0.001425166 0.006553443  0.0010144299</span></span>
<span><span class="co">#&gt; [24,]  0.000000e+00 -2.107489e-05  0.004843997 0.016800268  0.0067781747</span></span>
<span><span class="co">#&gt; [25,]  0.000000e+00 -8.859498e-06  0.002036328 0.008479515  0.0030955093</span></span>
<span><span class="co">#&gt; [26,]  0.000000e+00 -8.626625e-06  0.001982802 0.010122495  0.0022323503</span></span>
<span><span class="co">#&gt; [27,]  0.000000e+00 -1.364556e-05  0.003136388 0.012557039  0.0036196604</span></span>
<span><span class="co">#&gt; [28,]  0.000000e+00 -1.515004e-05  0.003482189 0.011933333  0.0081960749</span></span>
<span><span class="co">#&gt; [29,]  0.000000e+00 -1.296497e-05  0.002979957 0.015045507 -0.0017107194</span></span>
<span><span class="co">#&gt;              X19hex          Allo           Zea         Chl_b        Tchla</span></span>
<span><span class="co">#&gt;  [1,] -8.041962e-04 -3.376568e-04 -1.505768e-04 -3.484168e-03  0.164283515</span></span>
<span><span class="co">#&gt;  [2,] -1.273118e-03 -5.345421e-04 -2.383771e-04 -4.149725e-03  0.260076134</span></span>
<span><span class="co">#&gt;  [3,] -1.064978e-03 -4.471507e-04 -1.994052e-04 -1.010734e-03  0.217556704</span></span>
<span><span class="co">#&gt;  [4,] -9.304321e-04 -3.906592e-04 -1.742130e-04 -6.888635e-04  0.190071345</span></span>
<span><span class="co">#&gt;  [5,] -2.166449e-04 -9.096239e-05 -4.056434e-05  1.669699e-06  0.044256839</span></span>
<span><span class="co">#&gt;  [6,] -8.828286e-05 -3.706720e-05 -1.652998e-05  3.107503e-04  0.018034677</span></span>
<span><span class="co">#&gt;  [7,]  4.875891e-04  2.047233e-04  9.129562e-05 -8.967796e-04 -0.099606096</span></span>
<span><span class="co">#&gt;  [8,]  3.477113e-04  1.459931e-04  6.510506e-05  4.442483e-04 -0.071031463</span></span>
<span><span class="co">#&gt;  [9,]  8.621056e-05  3.619711e-05  1.614197e-05 -1.100851e-03 -0.017611341</span></span>
<span><span class="co">#&gt; [10,]  4.620240e-04  1.939894e-04  8.650885e-05 -1.393601e-03 -0.094383599</span></span>
<span><span class="co">#&gt; [11,]  2.012009e-04  8.447795e-05  3.767263e-05  1.899010e-03 -0.041101900</span></span>
<span><span class="co">#&gt; [12,]  2.258881e-04  0.000000e+00  4.229503e-05  7.811498e-04 -0.046145070</span></span>
<span><span class="co">#&gt; [13,]  1.999220e-04  0.000000e+00  3.743317e-05  2.175209e-03 -0.040840647</span></span>
<span><span class="co">#&gt; [14,]  3.718136e-04  1.561129e-04  6.961795e-05 -3.382436e-03 -0.075955153</span></span>
<span><span class="co">#&gt; [15,] -2.488233e-04 -1.044731e-04 -4.658939e-05 -8.274774e-03  0.050830340</span></span>
<span><span class="co">#&gt; [16,]  1.562880e-04  6.562043e-05  2.926319e-05 -9.477557e-03 -0.031926963</span></span>
<span><span class="co">#&gt; [17,] -1.117729e-04 -4.692992e-05 -2.092822e-05 -7.880297e-03  0.022833282</span></span>
<span><span class="co">#&gt; [18,]  2.707273e-04  1.136699e-04  5.069067e-05 -2.486666e-03 -0.055304947</span></span>
<span><span class="co">#&gt; [19,]  1.095767e-04  4.600783e-05  2.051702e-05 -3.474013e-03 -0.022384651</span></span>
<span><span class="co">#&gt; [20,]  1.099038e-04  4.614515e-05  2.057826e-05 -2.265071e-03 -0.022451463</span></span>
<span><span class="co">#&gt; [21,]  1.286102e-04  5.399939e-05  2.408083e-05 -2.988952e-03 -0.026272862</span></span>
<span><span class="co">#&gt; [22,] -1.642773e-05 -6.897489e-06 -3.075910e-06 -1.281776e-03  0.003355904</span></span>
<span><span class="co">#&gt; [23,] -9.297032e-05 -3.903532e-05 -1.740766e-05 -2.130429e-03  0.018992245</span></span>
<span><span class="co">#&gt; [24,]  3.159967e-04  1.326771e-04  5.916686e-05 -6.495509e-03 -0.064552718</span></span>
<span><span class="co">#&gt; [25,]  1.328392e-04  5.577503e-05  2.487267e-05 -3.162350e-03 -0.027136782</span></span>
<span><span class="co">#&gt; [26,]  1.293475e-04  5.430897e-05  2.421889e-05 -3.059299e-03 -0.026423488</span></span>
<span><span class="co">#&gt; [27,]  2.046014e-04  8.590570e-05  3.830933e-05 -4.152928e-03 -0.041796559</span></span>
<span><span class="co">#&gt; [28,]  2.271596e-04  9.537719e-05  4.253311e-05 -6.407416e-03 -0.046404819</span></span>
<span><span class="co">#&gt; [29,]  1.943966e-04  8.162104e-05  3.639860e-05 -1.866587e-03 -0.039711899</span></span>
<span><span class="va">Results</span><span class="op">$</span><span class="va">`F matrix`</span></span>
<span><span class="co">#&gt;                      Per X19but   Fuco   Neox   Viol X19hex   Allo      Zea</span></span>
<span><span class="co">#&gt; Chlorophytes      0.0000 0.0000 0.0000 0.0223 0.0559 0.0000 0.0000 0.008800</span></span>
<span><span class="co">#&gt; Cryptophytes      0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.5406 0.000000</span></span>
<span><span class="co">#&gt; Diatoms-2         0.0000 0.0000 0.7893 0.0000 0.0000 0.0000 0.0000 0.000000</span></span>
<span><span class="co">#&gt; Dinoflagellates-1 0.5611 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.000000</span></span>
<span><span class="co">#&gt; Haptophytes       0.0000 0.1078 0.2585 0.0000 0.0000 0.4263 0.0000 0.000000</span></span>
<span><span class="co">#&gt; Pelagophytes      0.0000 0.5890 0.9259 0.0000 0.0000 0.0000 0.0000 0.000000</span></span>
<span><span class="co">#&gt; Syn               0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.212254</span></span>
<span><span class="co">#&gt;                    Chl_b Tchla</span></span>
<span><span class="co">#&gt; Chlorophytes      0.7834     1</span></span>
<span><span class="co">#&gt; Cryptophytes      0.0000     1</span></span>
<span><span class="co">#&gt; Diatoms-2         0.0000     1</span></span>
<span><span class="co">#&gt; Dinoflagellates-1 0.0000     1</span></span>
<span><span class="co">#&gt; Haptophytes       0.0000     1</span></span>
<span><span class="co">#&gt; Pelagophytes      0.0000     1</span></span>
<span><span class="co">#&gt; Syn               0.0000     1</span></span>
<span><span class="va">Results</span><span class="op">$</span><span class="va">`Class abudances`</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">Results</span><span class="op">$</span><span class="va">Figure</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=phytoclass" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/phytoclass/phytoclass/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/phytoclass/phytoclass/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing phytoclass</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alexander Hayward <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
<li>Tylar Murray <br><small class="roles"> Author </small>   </li>
<li>Andy McKenzie <br><small class="roles"> Author </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Hayward, Tylar Murray, Andy McKenzie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
